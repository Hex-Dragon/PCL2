name: Issue Closed
run-name: '#${{ github.event.issue.number }} ${{ github.event.issue.title }}'

on:
  issues:
    types: [closed]

jobs:
  close-as-completed:
    if: github.actor != 'PCL-Community-Bot' && github.event.issue.state_reason == 'completed'
    runs-on: ubuntu-latest
    steps:
      - name: Check permission
        id: check
        uses: actions-cool/check-user-permission@main
        with:
          token: '${{ secrets.BOT }}'
          require: 'write'

      - name: Add labels (with permission)
        if: steps.check.outputs.check-result == 'true'
        uses: actions-cool/issues-helper@v3
        with:
          actions: 'add-labels'
          token: '${{ secrets.BOT }}'
          labels: 'ğŸ‘Œ å®Œæˆ'

      - name: Add labels (without permission)
        if: steps.check.outputs.check-result == 'false'
        uses: actions-cool/issues-helper@v3
        with:
          actions: 'add-labels'
          token: '${{ secrets.BOT }}'
          labels: 'âŒ å¿½ç•¥'

      - name: Remove labels
        uses: actions-cool/issues-helper@v3
        with:
          actions: 'remove-labels'
          token: '${{ secrets.BOT }}'
          labels: 'â­• ç­‰å¾…å¤„ç†,ğŸš§ æ­£åœ¨å¤„ç†,ğŸ•‘ ç­‰å¾…åˆå¹¶,ğŸ•‘ ç­‰å¾…å‰ç½®'

  close-as-duplicate:
    if: github.actor != 'PCL-Community-Bot' && github.event.issue.state_reason == 'duplicate'
    runs-on: ubuntu-latest
    steps:
      - name: Add labels
        uses: actions-cool/issues-helper@v3
        with:
          actions: 'add-labels'
          token: '${{ secrets.BOT }}'
          labels: 'âŒ é‡å¤'

      - name: Remove labels
        uses: actions-cool/issues-helper@v3
        with:
          actions: 'remove-labels'
          token: '${{ secrets.BOT }}'
          labels: 'âŒ å¿½ç•¥,âŒ æ‹’ç» / æ”¾å¼ƒ,âŒ æš‚æ— è®¡åˆ’,âŒ ç¬¬ä¸‰æ–¹,â­• ç­‰å¾…å¤„ç†'

  close-as-not-planned:
    if: github.actor != 'PCL-Community-Bot' && github.event.issue.state_reason == 'not_planned' && !(contains(github.event.issue.labels.*.name, 'âŒ') || contains(github.event.issue.labels.*.name, 'ğŸ˜‚'))
    runs-on: ubuntu-latest
    steps:
      - name: Add labels
        uses: actions-cool/issues-helper@v3
        with:
          actions: 'add-labels'
          token: '${{ secrets.BOT }}'
          labels: 'âŒ å¿½ç•¥'