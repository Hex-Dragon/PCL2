name: PR Label Automation

on:
  pull_request:
    types: [labeled, closed]

jobs:
  handle_labels:
    runs-on: ubuntu-latest
    steps:
      # è‡ªåŠ¨å…³é—­å¸¦æœ‰ç‰¹å®šæ ‡ç­¾çš„PR
      - name: Close PR with specific labels
        if: |
          github.event.action == 'labeled' && 
          contains('âŒ æ‹’ç»,ğŸ˜‚ ç§»äº¤ä¸Šæ¸¸,âŒ å¿½ç•¥,âŒ ç¬¬ä¸‰æ–¹,âŒ æš‚æ— è®¡åˆ’,âŒ é‡å¤', github.event.label.name)
        run: |
          curl -sS -X PATCH \
            -H "Accept: application/vnd.github.v3+json" \
            -H "Authorization: token ${{ secrets.BOT }}" \
            "https://api.github.com/repos/${{ github.repository }}/pulls/${{ github.event.pull_request.number }}" \
            -d '{"state": "closed"}'

      # åˆå¹¶åæ·»åŠ å®Œæˆæ ‡ç­¾
      - name: Add merged label
        if: |
          github.event.action == 'closed' &&
          github.event.pull_request.merged == true
        run: |
          curl -sS -X POST \
            -H "Accept: application/vnd.github.v3+json" \
            -H "Authorization: token ${{ secrets.BOT }}" \
            "https://api.github.com/repos/${{ github.repository }}/issues/${{ github.event.pull_request.number }}/labels" \
            -d '{"labels":["ğŸ‘Œ å®Œæˆ"]}'